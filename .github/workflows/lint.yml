name: Lint

on:
  pull_request:

jobs:
  lint:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4
        with:
          repository: ${{ github.event.pull_request.head.repo.full_name }}
          ref: ${{ github.event.pull_request.head.ref }}
          token: ${{ secrets.GITHUB_TOKEN }}

      - uses: actions/setup-node@v4
        with:
          node-version: 20.x
          cache: npm

      - run: npm ci
      - run: npm run lint -- --fix

      - name: Import GPG key
        uses: crazy-max/ghaction-import-gpg@v6
        with:
          gpg_private_key: ${{ secrets.GPG_PRIVATE_KEY }}
          passphrase: ${{ secrets.GPG_PRIVATE_KEY_PASSKEY }}

      - name: Git Commands
        # env:
        #   GPG_KEY_ID: ${{ secrets.GPG_KEY_ID }}
        run: |
          git config --global user.email "actions@github.com"
          git config --global user.name "GH Actions"
          git config --global commit.gpgSign true
          git config --global user.signingkey CF99FFE6AA2BBE2CE02963D57013A13FEB1CD390
          git add -A
          git commit --no-verify -S -m "Linting"
          git push
